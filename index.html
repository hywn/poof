<div id='dropzone'><h1>drop files here</h1></div>
<ul id='uploads'></ul>

<style>
html { display: flex; justify-content: center }
body { margin: 5em; width: 32em }
#dropzone { border: outset; display: flex; justify-content: center; align-items: center }
</style>

<script>
const DROPZONE   = document.querySelector('#dropzone')
const FILE_INPUT = document.querySelector('#file_input')
const UPLOADS    = document.querySelector('#uploads')

const form =
	obj =>
{
	const f = new FormData()

	for ([k, v] of Object.entries(obj))
		f.append(k, v)

	console.log(...f.entries())

	return f
}

const upload_file =
	file =>
		fetch('./upload.php', { method: 'POST', body: form({ file_data: file }) })

const nothing = e => e.preventDefault()
DROPZONE.addEventListener('dragenter', nothing)
DROPZONE.addEventListener('dragover', nothing)

DROPZONE.addEventListener('drop', e => {

	upload_file(e.dataTransfer.files[0]).then(r => r.json()).then(j => {
		if (!j.hash) {
			console.error(j)
			return
		}

		const li = document.createElement('li')
		li.innerHTML = `<a href='./file.php?hash=${j.hash}'>${j.hash}</a>`

		UPLOADS.appendChild(li)
	})

	e.preventDefault()
})
</script>